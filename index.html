<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Login â€” BTech Vault</title>
  <link rel="stylesheet" href="style.css"/>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-storage-compat.js"></script>
  <script src="firebase-config.js"></script>
</head>
<body>

<div class="login-page">
  <div class="login-card">
    <span class="logo-big">BTech<span style="color:var(--text2); font-weight:400;">Vault</span></span>
    <p class="tagline">// supply ki. backlogs ki. success ki.</p>

    <div style="background:var(--bg3); border:1px solid var(--border); border-radius:10px; padding:1.25rem; margin-bottom:1.5rem;">
      <p style="font-size:0.875rem; color:var(--text2); margin-bottom:0.75rem;">ðŸŽ“ <strong>Idi B.Tech students ki</strong> â€” free study PDFs share & access cheyyatanki</p>
      <div style="display:flex; flex-direction:column; gap:0.4rem;">
        <div style="font-size:0.8rem; color:var(--text3);">âœ… PDFs free ga browse cheyyochu (login lekundha)</div>
        <div style="font-size:0.8rem; color:var(--text3);">âœ… Login chesthe PDFs save cheyyochu</div>
        <div style="font-size:0.8rem; color:var(--text3);">âœ… Login chesthe PDFs upload cheyyochu</div>
        <div style="font-size:0.8rem; color:var(--accent3);">ðŸ”’ Nee saves others ki never show avvavu</div>
      </div>
    </div>

    <button class="btn-google" onclick="handleGoogleLogin()" id="loginBtn">
      <img src="https://www.google.com/favicon.ico" alt="Google" style="width:18px; margin-right:8px;"/>
      Continue with Google
    </button>

    <div id="errorMsg" style="display:none; background:rgba(248,113,113,0.1); border:1px solid #f87171; border-radius:8px; padding:0.75rem; margin-top:1rem; font-size:0.85rem; color:#f87171;"></div>

    <div class="login-divider">or just browse</div>

    <a href="index.html" class="btn btn-outline" style="width:100%; justify-content:center; text-decoration:none; display:flex; align-items:center;">
      Browse PDFs (No Login)
    </a>

    <p style="text-align:center; font-size:0.75rem; color:var(--text3); margin-top:1.5rem; font-family:'DM Mono',monospace;">
      Nee data safe ga untundi. We don't sell anything.
    </p>
  </div>
</div>

<script>
// 1. Check if user is already logged in
auth.onAuthStateChanged((user) => {
  if (user) {
    // Already logged in ayithe index.html ki vellipo
    window.location.href = 'index.html';
  }
});

// 2. Main Login Function
async function handleGoogleLogin() {
  const btn = document.getElementById('loginBtn');
  const errDiv = document.getElementById('errorMsg');

  btn.disabled = true;
  btn.innerText = "Logging in...";
  errDiv.style.display = 'none';

  try {
    // Google Provider setup
    const provider = new firebase.auth.GoogleAuthProvider();
    // Popup open avthundhi
    await auth.signInWithPopup(provider);
    
    // Success ayyaka home page ki redirect
    window.location.href = 'index.html';
  } catch (err) {
    console.error(err);
    errDiv.style.display = 'block';
    errDiv.textContent = 'Error: ' + err.message;
    btn.disabled = false;
    btn.innerHTML = `<img src="https://www.google.com/favicon.ico" alt="Google" style="width:18px; margin-right:8px;"/> Continue with Google`;
  }
}
</script>
</body>
</html>
